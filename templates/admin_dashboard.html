{% extends "base.html" %}

{% block content %}
<h2>Admin Dashboard</h2>

<div class="cards">
  <div class="card">
    <h3>Total Users</h3>
    <p>{{ total_users }}</p>
  </div>

  <div class="card">
    <h3>Total Complaints</h3>
    <p>{{ total_complaints }}</p>
  </div>

  <div class="card">
    <h3>Pending</h3>
    <p>{{ pending }}</p>
  </div>

  <div class="card">
    <h3>In Progress</h3>
    <p>{{ in_progress }}</p>
  </div>

  <div class="card">
    <h3>Resolved</h3>
    <p>{{ resolved }}</p>
  </div>
</div>

<hr>

<h3 class="section-title">All Complaints</h3>

{% for c in complaints %}
<div class="complaint-card">

  <div class="complaint-title">{{ c.title }}</div>
  <div class="complaint-desc">{{ c.description }}</div>

  <span class="status {{ c.status }}">{{ c.status }}</span>

  <div class="meta">
    User ID: {{ c.user_id }} <br>
    Created at: {{ c.created_at }}
  </div>

  {% if c.status != "Resolved" %}
    <div class="actions" style="margin-top:10px;">
      <a href="{{ url_for('mark_in_progress', id=c.id) }}">In Progress</a>
    </div>

    <form method="POST"
          action="{{ url_for('resolve_complaint', complaint_id=c.id) }}"
          style="margin-top:10px;">
      <textarea name="note"
        placeholder="Resolve note"
        required
        style="width:100%; height:60px;"></textarea>
      <br>
      <button class="btn btn-danger" type="submit">Resolve</button>
    </form>
  {% else %}
    <div class="meta" style="margin-top:8px;">
      âœ… Resolved at: {{ c.resolved_at }}
    </div>

    <div class="resolve-note">
      ğŸ“ {{ c.resolve_note }}
    </div>
  {% endif %}

</div>
{% endfor %}


{% endblock %}



